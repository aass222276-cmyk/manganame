<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<link rel="manifest" href="manifest.webmanifest" />
<title>manganame</title>
<style>
  :root{
    --panel-border: 3px;     /* コマ枠の太さ */
    --edge-thick: 2.5px;     /* 分割の黒線の太さ（両側） */
    --pad-x: 14px;           /* セリフの左右パディング */
    --pad-y: 12px;           /* セリフの上下パディング */
    --ui-h: 46px;
  }
  html,body{margin:0;height:100%;background:#ececec;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Sans","Noto Sans JP",sans-serif}
  #topbar{
    position:fixed;inset:0 0 auto 0;height:var(--ui-h);display:flex;gap:.5rem;
    align-items:center;padding:6px 10px;background:#fff;border-bottom:1px solid #ddd;z-index:1000;
  }
  #pagebar{margin-left:auto;display:flex;gap:.5rem;align-items:center}
  button,select,input[type="range"]{height:32px}
  #sizeLabel{min-width:44px;display:inline-block;margin-left:6px}
  #root{position:fixed;inset:var(--ui-h) 0 0 0;overflow:auto;}

  /* ===== ページ ===== */
  .page{
    position:relative;margin:24px auto;background:#f9f9f9;
    width:min(820px,calc(100% - 24px)); aspect-ratio:707/1000; /* B5相当比 */
    outline:2px solid #ddd;
  }
  .page.active{outline:4px solid #3a8cff;} /* 有効ページの枠を太くして可視化 */

  /* ===== コマ ===== */
  .panel{
    position:absolute;background:#fff;border:var(--panel-border) solid #000;box-sizing:border-box;
    overflow:visible;
  }

  /* ===== 分割（白い溝 ＋ 両側の黒線 ＝ 二重線） ===== */
  .gutter{position:absolute;pointer-events:none}
  .gutter .gap{position:absolute;background:#fff}
  .gutter .edge{position:absolute;background:#000}

  /* ===== セリフ（フキダシ） ===== */
  .balloon{
    position:absolute;background:#fff;border:2px solid #000;box-sizing:content-box;
    padding:var(--pad-y) var(--pad-x);min-width:32px;min-height:32px;user-select:text;
  }
  .balloon .text{
    outline:none;display:inline-block;white-space:pre; /* ★ 改行のみ反映（自動折返ししない） */
    line-height:1.25;
  }
  .balloon.ellipse{border-radius:9999px}
  .balloon.rect{border-radius:0}             /* ★ 直角の四角 */
  .balloon.jaggy{
    border-radius:0;
    /* 簡易ギザギザ輪郭（見た目を分かりやすく） */
    clip-path: polygon(
      0% 0%, 95% 0%, 100% 15%, 85% 10%, 90% 25%, 75% 20%,
      80% 35%, 65% 30%, 70% 45%, 55% 40%, 60% 55%, 45% 50%,
      50% 65%, 35% 60%, 40% 75%, 25% 70%, 30% 85%, 15% 80%,
      20% 95%, 0% 100%, 0% 0%
    );
  }
  .balloon.selected{outline:3px solid #3a8cff;outline-offset:1px}

  /* shape パレット（選択時だけ表示） */
  #shapeBar{
    position:fixed;left:8px;bottom:8px;display:none;gap:.5rem;padding:6px;background:#fff;
    border:1px solid #ddd;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,.08);z-index:1100;
  }
  #shapeBar.show{display:flex}
</style>
</head>
<body>
<div id="topbar">
  <button id="addTextBtn" title="セリフモードのON/OFF">セリフ</button>
  <button id="splitBtn"  title="コマ割りモードのON/OFF">コマ枠追加</button>

  <label style="display:flex;align-items:center;gap:.4rem;margin-left:8px">
    文字サイズ
    <input id="fontSize" type="range" min="12" max="48" step="1" />
    <span id="sizeLabel"></span>
  </label>

  <div id="pagebar">
    <button id="addPrev">↑ページ追加</button>
    <button id="addNext">↓ページ追加</button>
    <button id="delPage">今のページ削除</button>
  </div>
</div>

<div id="root"></div>

<!-- セリフ選択時：形状切替パレット -->
<div id="shapeBar">
  <button data-shape="ellipse">楕円</button>
  <button data-shape="rect">四角</button>
  <button data-shape="jaggy">ギザギザ</button>
</div>

<script src="app.js"></script>
</body>
</html>
